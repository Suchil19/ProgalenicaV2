<!DOCTYPE html>
<html lang="en">
<head>
  <title>Administrador | Progalenica</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cabin:ital,wght@0,400..700;1,400..700&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Poetsen+One&family=Reddit+Sans:ital,wght@0,200..900;1,200..900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
  <link rel="stylesheet"
  href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  <link rel="stylesheet" href="../../css/style.css">
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="./css/agregar-producto.css">
  
</head>
<body ondragstart="return false" onselectstart="return false" oncontextmenu="return false">
  <div id="preloader"></div>

 <header class="header">
    <div class="container">
        <div class="row align-items-center justify-content-between">
            <div class="logo">
               <a href="../../index.html"><!--Progalenica--><img class="logo" src="../../img/logo/logo-progalenica.png"></a>
               
            </div>
            <button type="button" class="nav-toggler">
               <span></span>
            </button>
            <nav class="nav">
               <ul>
                  <li><a href="../../index.html" class="active">Inicio</a></li>
                  <!--li><a href="#">Ingresa | Registrate</a></li-->
                  <li><a href="../perfil.html">Perfil</a></li>
               </ul>
            </nav>
        </div>
    </div>
 </header>



 <!--aside class="sidebar">
    <div class="sidebar-header">
      <img src="images/logo.png" alt="logo" />
      <h2>Progalenica</h2>
    </div>
    <ul class="sidebar__links">
      <h4>
        <span>Menu Principal</span>
        <div class="menu-separator"></div>
      </h4>
      <li>
        <a href="#">
          <span class="material-symbols-outlined"> dashboard </span>Panel</a>
      </li>
      <li>

      <h4>
        <span>Productos</span>
        <div class="menu-separator"></div>
      </h4>
      <li>
        <a href="./agregar-producto.html"><span class="material-symbols-outlined"> <span class="material-symbols-outlined">
            add_circle
            </span></span>Agregar Producto</a>
      </li>
      <li>
        <a href="#"><span class="material-symbols-outlined"> groups </span>Opción 01</a>
      </li>
      <li>
        <a href="#"><span class="material-symbols-outlined"> move_up </span>Opción 02</a>
      </li>
      <li>
        <a href="#"><span class="material-symbols-outlined"> flag </span>Opción 03</a>
      </li>
      <li>
        <a href="#"><span class="material-symbols-outlined">
            notifications_active </span>Notificaciones</a>
      </li>
      <h4>
        <span>Cuenta</span>
        <div class="menu-separator"></div>
      </h4>
      <li>
        <a href="#"><span class="material-symbols-outlined"> account_circle </span>Perfil</a>
      </li>
   
    </ul>
    <div class="cuenta__usuario">
      <div class="perfil__usuario">
        <img src="https://images.unsplash.com/photo-1697131956380-b22437266e78?q=80&w=1740&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt="Profile Image" />
        <div class="user-detail">
          <h3>Raquel</h3>
          <span>Arsmtrong</span>
        </div>
      </div>
    </div>
  </aside-->

<section id="hero">
  <div class="hero-text">
      <h1>Progalenica</h1>
      <p>Agregar Productos</p>
  </div>
</section>


<!--Dashboard-->

<div class="form-container">
  <h2>Agregar Producto</h2>
  <form id="form-producto">
    <label for="nombre">Nombre <span style="color:red">*</span></label>
    <input type="text" id="nombre" name="nombre" required>

    <label for="laboratorio">Laboratorio</span></label>
    <input type="text" id="laboratorio" name="laboratorio">

    <label for="precio_unitario">Precio unitario <span style="color:red">*</span></label>
    <input type="number" id="precio_unitario" name="precio_unitario" required min="0" step="0.01">

    <label for="cantidad_real">Cantidad en Stock <span style="color:red">*</span></label>
    <input type="number" id="cantidad_real" name="cantidad_real" required min="0" step="1">

    <label for="codigo_barras">Código de Barras</label>
    <input type="text" id="codigo_barras" name="codigo_barras">

    <fieldset style="margin-top:1rem;">
      <legend>Descripción</legend>
      <label for="presentacion">Presentación <span style="color:red">*</span></label>
      <input type="text" id="presentacion" name="presentacion" required>

      <label for="dosis">Dosis <span style="color:red">*</span></label>
      <input type="text" id="dosis" name="dosis" required>

      <label for="via_administracion">Vía de administración <span style="color:red">*</span></label>
      <input type="text" id="via_administracion" name="via_administracion" required>

      <label for="descripcion_detalle">Descripción <span style="color:red">*</span></label>
      <textarea id="descripcion_detalle" name="descripcion_detalle" rows="3" required></textarea>
    </fieldset>

    <label for="imagen">Imagen del producto</label>
    <input type="file" id="imagen" name="imagen" accept="image/*">
    <small>Si no seleccionas una imagen se usará una por defecto.</small>

    <button type="submit">Guardar producto</button>
  </form>
</div>
<script>
document.getElementById('form-producto').addEventListener('submit', async function(e) {
  e.preventDefault();
  const defaultImg = 'https://res.cloudinary.com/dfvrlkbsv/image/upload/v1750375615/composicion-colorida-nuevo-producto-diseno-plano_23-2147927006_bmoj0g.avif';
  const imagenInput = document.getElementById('imagen');
  let imagen = '';
  if (imagenInput.files && imagenInput.files[0]) {
    // Aquí deberías subir la imagen y obtener la URL real, por ahora solo el nombre
    imagen = imagenInput.files[0].name;
  } else {
    imagen = defaultImg;
  }

  const data = {
    nombre: document.getElementById('nombre').value,
    laboratorio: document.getElementById('laboratorio').value,
    precio_unitario: parseFloat(document.getElementById('precio_unitario').value),
    cantidad_real: parseInt(document.getElementById('cantidad_real').value),
    codigo_barras: document.getElementById('codigo_barras').value,
    descripcion: {
      presentacion: document.getElementById('presentacion').value,
      dosis: document.getElementById('dosis').value,
      via_administracion: document.getElementById('via_administracion').value,
      descripcion: document.getElementById('descripcion_detalle').value
    },
    imagen: imagen
  };

  try {
    const response = await fetch('http://localhost:3002/progalenica/productos/', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(data)
    });
    const result = await response.json();
    if(result.success) {
      alert('Producto guardado correctamente');
      this.reset();
    } else {
      alert(result.message || 'Error al guardar el producto');
    }
  } catch (err) {
    alert('Error de conexión o de servidor');
  }
});
</script>

 <section class="footer">
    <div class="footer__row">
      <div class="footer__col">
        <h4>Info</h4>
        <ul class="links">
          <li><a href="#">Acerca de</a></li>
          <li><a href="#">Contacto</a></li>
          <li><a href="#">Servicios</a></li>
        </ul>
      </div>
      <div class="footer__col">
        <h4>Explora</h4>
        <ul class="links">
          <li><a href="#">Descripción 01</a></li>
          <li><a href="#">Descripción 02</a></li>
          <li><a href="#">Descripción 03</a></li>
        </ul>
      </div>
      <div class="footer__col">
        <h4>Legal</h4>
        <ul class="links">
          <li><a href="#">Aviso de Privacidad</a></li>
          <li><a href="#">Términos y Condiciones</a></li>
          <li><a href="#">Descripción 03</a></li>
        </ul>
      </div>
      <div class="footer__col">
        <h4>Sobre Nosotros</h4>
        <p>
          Subscribe to our newsletter for a weekly dose
          of news, updates, helpful tips, and
          exclusive offers.
        </p>
        <!--form action="#">
          <input type="text" placeholder="Your email" required>
          <button type="submit">SUBSCRIBE</button>
        </form-->
        <div class="icons">
          <i class="fa-brands fa-facebook-f"></i>
          <i class="fa-brands fa-x"></i>
          <i class="fa-brands fa-linkedin"></i>
          <i class="fa-brands fa-tiktok"></i>
        </div>
      </div>
    </div>
  </section>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js'></script>
  <!--script src="../js/buscador.js"></script-->
<script src="../../js/main.js"></script>
<script src="../js/registro.js"></script>

</body>
</html>
